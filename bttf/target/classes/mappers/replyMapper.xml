<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="kr.co.bttf.mappers.replyMapper">

<!-- 
========================================
			01. HTML
========================================
-->

	
<!-- 
========================================
			02. CSS
========================================
-->
 
 
<!-- 
========================================
			03. JAVASCRIPT
========================================
-->
 
 

<!-- 
========================================
			06. ORACLE
========================================
-->

	<!-- 1. 댓글 조회 --> 
	
	<sql id="pagingHeader">
		select * from (
			select rownum as rn, A.* from(
	</sql>
	
	
	<sql id="pagingFooter">
			)A
		) where rn between #{start} and #{end}
	</sql>
	
	
	<select id="oracleReplyList" parameterType="hashmap" resultType="kr.co.bttf.domain.OracleReplyVO">
		
		<include refid="pagingHeader"/>
	 		select *
			from reply_oracle ro, user_all 
			where ro.user_nickname = m.user_nickname and post_id = #{post_id} and avaliability_category_id = 1
			order by reply_id
		<include refid="pagingFooter"/>
		
	</select>
	
	<select id="oracleCount" resultType="_int">
	 	select count(*) from reply_oracle where post_id = #{post_id}
	</select>

	<!-- 2. 댓글 작성 --> 
	<insert id="oracleReplyWrite" parameterType="kr.co.bttf.domain.OracleReplyVO">
		insert into reply_oracle(post_id, reply_id, user_nickname, reply_contents) 
		values(#{post_id}, #{reply_id}, #{user_nickname}, #{reply_contents})
	</insert>

	<!-- 3. 댓글 수정 --> 
	<update id="oracleReplyModify" parameterType="kr.co.bttf.domain.OracleReplyVO">
		update reply_oracle set
		reply_contents = #{reply_contents}
		where post_id = #{post_id} and reply_id = #{reply_id}
	</update>

	<!-- 4. 댓글 삭제 --> 
<!--  	<delete id="oracle_reply_delete" parameterType="kr.co.bttf.domain.OracleReplyVO"> -->
<!-- 		delete from reply_oracle -->
<!-- 		where post_id = #{post_id} and reply_id = #{reply_id} -->
<!-- 	</delete> -->

	<update id="oracleReplyDelete" parameterType="kr.co.bttf.domain.OracleReplyVO">
		update reply_oracle set
		avaliability_category_id = 4
		where post_id = #{post_id} and reply_id = #{reply_id}
	</update>
 

</mapper>


